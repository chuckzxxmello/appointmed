

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- title -->    <title>Login</title>

  <link rel="stylesheet" href="../../../styles/nobgstylesheet.css">

    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script> 
</head>

<body>

<!-- header -->
<div class="header">
    <nav>
      <h2>ELAD School of Potentials Therapy Center</h2>
    </nav>
  </div>

<a href="../adminhome.html">Go Back to Admin Dashboard</a>
<a href="setappoint.html">Manage Appointment</a>

<h1>Manage Users</h1>

<div class="margin">
<form class ="add">
    <div class="forname">
        <h2>Name of Client</h2>
        <input type="text" name="firstName" placeholder="Given Name" required>
        <input type="text" name="middleName"placeholder="Middle" >
        <input type="text" name="surname" placeholder="Surname" required>
        <br>

   <h2>Contact Info of Client</h2>
        <input type="text" name="email" placeholder="Email (@gmail.com)"required>
        <input type="text" name="phoneNumber"placeholder="Phone Number" required>

    <h2>Other</h2>
    <label for="professional">Requested Professional (Optional) </label>
        <input type="text" name="professional" >
        <br><br>


        <button class="roundedbutton">Add user to database</button>
          

</form>

<form class="update-form">
  <label for="id">User ID</label>
  <input type="text" id="id" name="id"  required><br><br>

  <label for="firstName">First Name</label>
  <input type="text" id="firstName" name="firstName"><br><br>

  <label for="middleName">Middle Name (If any)</label>
  <input type="text" id="middleName" name="middleName" ><br><br>

  <label for="surname">Surname</label>
  <input type="text" id="surname" name="surname"><br><br>

  <label for="email">Email</label>
  <input type="email" id="email" name="email"><br><br>

  <label for="professional">Requested Professional (Optional)</label>
  <input type="text" id="professional" name="professional"><br><br>

  <label for="phoneNumber">Phone Number</label>
  <input type="text" id="phoneNumber" name="phoneNumber"><br><br>

  <button class="roundedbutton">Update User</button>
</form>

<form class="delete">
    <h2>Delete User from database</h2>
    <label for="id">User ID</label>
        <input type="text" name="id" required>
        <br>
        <button class="deletes">Delete from database</button>

        <button class=""></button><a href="../adminhome.html">Go Back to Admin Dashboard</a></button>
    

</form>

<br>
<br>

    <table class="table" id="myTable" border="3"></table>




<!-- footer -->

    <div class="footer"> 
        <div class="social-links">
            <a href="https://www.facebook.com/ELADSchoolofPotentials" class="footer-style-button">Facebook</a>
        </div>
        <p>&copy; 2024 ELAD School of Potentials Therapy Center</p>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged, sendEmailVerification } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"; 
    
        const firebaseConfig = {
          apiKey: "AIzaSyCZfi1aIc3zDdZD7NR7kN2Jm4hnCtPHWcQ",
          authDomain: "appointment-scheduling-s-57d01.firebaseapp.com",
          databaseURL: "https://appointment-scheduling-s-57d01-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "appointment-scheduling-s-57d01",
          storageBucket: "appointment-scheduling-s-57d01.firebasestorage.app",
          messagingSenderId: "1069885306589",
          appId: "1:1069885306589:web:b31768194add4087754d34",
          measurementId: "G-KQ4PQZZZBM"
        };
    
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
    
        function updateDropdownEmail(user) {
          const emailButton = document.getElementById('emailBtn');
          const userDropdown = document.getElementById('userDropdown');
          if (user) {
            emailButton.textContent = user.email;
            emailButton.onclick = () => { 
              if (userDropdown.style.display === 'block') {
                userDropdown.style.display = 'none';
              } else {
                userDropdown.style.display = 'block';
              }
            };
          } else {
            emailButton.textContent = "Login";
            emailButton.onclick = () => {
              window.location.href = '../login.html';
            };
          }
        }
    
      // Use browserLocalPersistence for more persistent logins
      setPersistence(auth, browserLocalPersistence)
              .then(() => {
                  console.log('Persistence set to local.');
              })
              .catch((error) => {
                  console.error('Error setting persistence:', error);
              });

          document.addEventListener('DOMContentLoaded', (event) => {
              onAuthStateChanged(auth, (user) => {
                  console.log('Auth state changed triggered.');
                  setTimeout(() => {
                      if (user) {
                          console.log("User logged in:", user.email);
                          localStorage.setItem('userEmail', user.email);
                          if (user.email === 'admin.control@mail.com') {
                              console.log("Admin is logged in:", user.email);
                              if (window.location.pathname !== '/path/to/admin/dashboard') {
                                  window.location.href = '/path/to/admin/dashboard';
                              }
                          } else {
                              console.log("User is logged in:", user.email);
                              if (window.location.pathname !== '/path/to/user/homepage') {
                                  window.location.href = '/path/to/user/homepage';
                              }
                          }
                      } else {
                          console.log("User is not logged in.");
                          localStorage.removeItem('userEmail');
                          window.location.href = '../auth/login.html';
                      }
                  }, 10800000); // timeout ms
              });
          });
    
        document.getElementById('logoutBtn').addEventListener('click', signOutUser);
    
      </script>

<script type="module" src="index.js"></script>
</body>
</html>