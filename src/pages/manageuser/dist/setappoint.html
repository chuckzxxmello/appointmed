<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Appointment</title>
</head>
<body>
    
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- title -->    <title>Login</title>

<link rel="stylesheet" href="../../../styles/stylesheet.css">

    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script> 
</head>

<body>

<!-- header -->

  <div class="header">
    <nav>
      <h2>ELAD School of Potentials Therapy Center</h2>
      <ul>
        <li><a href="../adminhome.html">Admin Dashboard</a></li>
        <li><a href="../../calendar/calendaredit.html">View Calendar and Schedules</a></li>
      </ul>
    </nav>
  </div>

  <div class="manage-user"> 
    <br>
    <!-- Unique IDs for each button -->
    <button class="addel" id="addAppointmentButton">Add Appointment</button>
    <button class="addel" id="updateAppointmentButton">Update Appointment</button>
    <button class="addel" id="deleteAppointmentButton">Delete Appointment</button>
  
    <script>
      // Event listener for Add Appointment button
      document.getElementById("addAppointmentButton").addEventListener("click", function() {
        var setForm = document.getElementById("setForm");
        var updateForm = document.getElementById("updateForm");
        var deleteForm = document.getElementById("deleteForm");
  
        // Show the Add Appointment form and hide the others
        setForm.style.display = "block";
        updateForm.style.display = "none";
        deleteForm.style.display = "none";
      });
  
      // Event listener for Update Appointment button
      document.getElementById("updateAppointmentButton").addEventListener("click", function() {
        var setForm = document.getElementById("setForm");
        var updateForm = document.getElementById("updateForm");
        var deleteForm = document.getElementById("deleteForm");
  
        // Show the Update Appointment form and hide the others
        setForm.style.display = "none";
        updateForm.style.display = "block";
        deleteForm.style.display = "none";
      });
  
      // Event listener for Delete Appointment button
      document.getElementById("deleteAppointmentButton").addEventListener("click", function() {
        var setForm = document.getElementById("setForm");
        var updateForm = document.getElementById("updateForm");
        var deleteForm = document.getElementById("deleteForm");
  
        // Show the Delete Appointment form and hide the others
        setForm.style.display = "none";
        updateForm.style.display = "none";
        deleteForm.style.display = "block";
      });
    </script>
  
    <h1>Manage Appointments </h1>
  
    <!-- Set Appointment Form -->
<form class="set" id="setForm" style="display:none;"> <!-- SET -->
  <h2>Add an Appointment Schedule</h2>
  <label for="appointmentDate">Full Name of Client:</label>
  <input type="text" id="firstName" name="firstName" placeholder="First Name">
  <input type="text" id="middleName" name="middleName" placeholder="Middle Name">
  <input type="text" id="surname" name="surname" placeholder="Last Name" required>
  <label for="email">Email</label>
  <input type="text" id="email" name="email" required placeholder="john.doe@gmail.com">
  <label for="contact">Phone Number</label>
  <input type="text" id="contact" name="contact" required placeholder="+63-XXX-XXXX-XXX">
  
  <!-- Dropdown for Type of Appointment -->
  <label for="appointType">Type of Appointment</label>
  <select name="appointmentType" required>
    <option value="CONSULTATION">CONSULTATION</option>
    <option value="THERAPY">THERAPY</option>
    <option value="CHECK_UP">CHECK-UP</option>
    <option value="TRAINING_SESSION">TRAINING SESSION</option>
    <option value="COACHING">COACHING</option>
    <option value="DIAGNOSTIC">DIAGNOSTIC</option>
    <option value="TREATMENT">TREATMENT</option>
    <option value="FOLLOW_UP">FOLLOW-UP</option>
    <option value="INTERVIEW">INTERVIEW</option>
    <option value="SUPPORT">SUPPORT</option>
  </select>
  
  <label for="doctor">Doctor</label>
  <input type="text" name="doctor" placeholder="Doctor's Name">    
  <br><br>
  <label for="appointmentDate">Select Date:</label>
  <input type="date" id="appointmentDate" name="appointmentDate" required>
  <label for="appointmentTime">Select Time: (Start to End of Appointment)</label>
  <input type="time" id="appointmentTime" name="appointmentTimeStart" required>
  <input type="time" id="appointmentTime" name="appointmentTimeEnd" required>
  <br><br>

  <!-- Dropdown for Payment Method -->
  <label for="paymentType">Payment Method</label>
  <select name="paymentType" required>
    <option value="BANK_TRANSFER">BANK_TRANSFER</option>
    <option value="ONLINE_PAYMENT">ONLINE_PAYMENT</option>
    <option value="CASH">CASH</option>
    <option value="OTHER">OTHER</option>
  </select>

  <label for="payment">Cost of Appointment</label>
  <input type="number" name="payment" required placeholder="Amount in PHP">
  
  <!-- Dropdown for Payment Status -->
  <label for="paymentStatus">Payment Status</label>
  <select name="paymentStatus" required>
    <option value="PAID">PAID</option>
    <option value="NOT_PAID">NOT_PAID</option>
    <option value="PARTIALLY_PAID">PARTIALLY_PAID</option>
    <option value="PENDING">PENDING</option>
    <option value="REFUNDED">REFUNDED</option>
    <option value="CANCELLED">CANCELLED</option>
    <option value="ON_HOLD">ON_HOLD</option>
  </select>

  <!-- Dropdown for Appointment Status -->
  <label for="appointmentStatus">Appointment Status</label>
  <select name="appointmentStatus" required>
    <option value="PENDING">PENDING</option>
    <option value="ONGOING">ONGOING</option>
    <option value="FINISHED">FINISHED</option>
    <option value="CANCELLED">CANCELLED</option>
    <option value="NO_SHOW">NO_SHOW</option>
    <option value="RESCHEDULED">RESCHEDULED</option>
    <option value="CONFIRMED">CONFIRMED</option>
    <option value="CONFIRMING">CONFIRMING</option>
    <option value="IN_PROGRESS">IN_PROGRESS</option>
    <option value="DECLINED">DECLINED</option>
    <option value="EXPIRED">EXPIRED</option>
    <option value="OVERDUE">OVERDUE</option>
  </select>

  <br><br>
  <button class="roundedbutton">Add Appointment</button>
</form>

<!-- Update Appointment Form -->
<form class="update-form" id="updateForm" style="display:none;"> <!-- UPDATE -->
  <h2>Update Appointment Schedule</h2>
  <label for="appointmentDate">Full Name of Client:</label>
  <input type="text" name="id" required placeholder="Appointment ID">
  <br><br>
  <input type="text" id="firstName" name="firstName" placeholder="First Name">
  <input type="text" id="middleName" name="middleName" placeholder="Middle Name">
  <input type="text" id="surname" name="surname" placeholder="Last Name" required>
  <label for="email">Email</label>
  <input type="text" id="email" name="email" required placeholder="john.doe@gmail.com">
  <label for="contact">Phone Number</label>
  <input type="text" id="contact" name="contact" required placeholder="+63-XXX-XXXX-XXX">

  <!-- Dropdown for Type of Appointment -->
  <label for="appointType">Type of Appointment</label>
  <select name="appointmentType" required>
    <option value="CONSULTATION">CONSULTATION</option>
    <option value="THERAPY">THERAPY</option>
    <option value="CHECK_UP">CHECK-UP</option>
    <option value="TRAINING_SESSION">TRAINING_SESSION</option>
    <option value="COACHING">COACHING</option>
    <option value="DIAGNOSTIC">DIAGNOSTIC</option>
    <option value="TREATMENT">TREATMENT</option>
    <option value="FOLLOW_UP">FOLLOW_UP</option>
    <option value="INTERVIEW">INTERVIEW</option>
    <option value="SUPPORT">SUPPORT</option>
  </select>

  <label for="doctor">Doctor</label>
  <input type="text" name="doctor" placeholder="Doctor's Name">
  <br><br>
  <label for="appointmentDate">Select Date:</label>
  <input type="date" id="appointmentDate" name="appointmentDate" required>
  <label for="appointmentTime">Select Time: (Start to End of Appointment)</label>
  <input type="time" id="appointmentTime" name="appointmentTimeStart" required>
  <input type="time" id="appointmentTime" name="appointmentTimeEnd" required>
  <br><br>

  <!-- Dropdown for Payment Method -->
  <label for="paymentType">Payment Method</label>
  <select name="paymentType" required>
    <option value="BANK_TRANSFER">BANK_TRANSFER</option>
    <option value="ONLINE_PAYMENT">ONLINE_PAYMENT</option>
    <option value="CASH">CASH</option>
    <option value="OTHER">OTHER</option>
  </select>

  <label for="payment">Cost of Appointment</label>
  <input type="number" name="payment" required placeholder="Amount in PHP">

  <!-- Dropdown for Payment Status -->
  <label for="paymentStatus">Payment Status</label>
  <select name="paymentStatus" required>
    <option value="PAID">PAID</option>
    <option value="NOT_PAID">NOT_PAID</option>
    <option value="PARTIALLY_PAID">PARTIALLY_PAID</option>
    <option value="PENDING">PENDING</option>
    <option value="REFUNDED">REFUNDED</option>
    <option value="CANCELLED">CANCELLED</option>
    <option value="ON_HOLD">ON_HOLD</option>
  </select>

  <!-- Dropdown for Appointment Status -->
  <label for="appointmentStatus">Appointment Status</label>
  <select name="appointmentStatus" required>
    <option value="PENDING">PENDING</option>
    <option value="ONGOING">ONGOING</option>
    <option value="FINISHED">FINISHED</option>
    <option value="CANCELLED">CANCELLED</option>
    <option value="NO_SHOW">NO_SHOW</option>
    <option value="RESCHEDULED">RESCHEDULED</option>
    <option value="CONFIRMED">CONFIRMED</option>
    <option value="CONFIRMING">CONFIRMING</option>
    <option value="IN_PROGRESS">IN_PROGRESS</option>
    <option value="DECLINED">DECLINED</option>
    <option value="EXPIRED">EXPIRED</option>
    <option value="OVERDUE">OVERDUE</option>
  </select>

  <br><br>
  <button class="roundedbutton">Update</button>
</form>

  
    <!-- Delete Appointment Form -->
    <form class="deleteappoint" id="deleteForm" style="display:none;"> <!-- DELETE -->
      <h2>Delete Appointment from Database</h2>
      <label for="id">Appointment ID</label>
      <input type="text" name="id" required placeholder="Example: kM0L0iVE8Mkkm1I1vY1d">
      <br><br>
      <button class="deletes">Delete from Database</button>
    </form>

    <table class="table" id="appointmentTable" border="3"><h2>View Users</h2></table>
  </div>
  

    <div class="footer"> 
        <div class="social-links">
            <a href="https://www.facebook.com/ELADSchoolofPotentials" class="footer-style-button">Facebook</a>
        </div>
        <p>&copy; 2024 ELAD School of Potentials Therapy Center</p>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged, sendEmailVerification } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"; 
    
        const firebaseConfig = {
          apiKey: "AIzaSyCZfi1aIc3zDdZD7NR7kN2Jm4hnCtPHWcQ",
          authDomain: "appointment-scheduling-s-57d01.firebaseapp.com",
          databaseURL: "https://appointment-scheduling-s-57d01-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "appointment-scheduling-s-57d01",
          storageBucket: "appointment-scheduling-s-57d01.firebasestorage.app",
          messagingSenderId: "1069885306589",
          appId: "1:1069885306589:web:b31768194add4087754d34",
          measurementId: "G-KQ4PQZZZBM"
        };
    
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
    
        function updateDropdownEmail(user) {
          const emailButton = document.getElementById('emailBtn');
          const userDropdown = document.getElementById('userDropdown');
          if (user) {
            emailButton.textContent = user.email;
            emailButton.onclick = () => { 
              if (userDropdown.style.display === 'block') {
                userDropdown.style.display = 'none';
              } else {
                userDropdown.style.display = 'block';
              }
            };
          } else {
            emailButton.textContent = "Login";
            emailButton.onclick = () => {
              window.location.href = '../login.html';
            };
          }
        }
    
        onAuthStateChanged(auth, (user) => {
          if (user) {
            updateDropdownEmail(user);
    
            user.reload()
              .then(() => {
                const verifyBtn = document.getElementById('verifyBtn');
                if (user.emailVerified) {
                  verifyBtn.textContent = "Email Verified";
                  verifyBtn.removeAttribute('href');
                } else {
                  verifyBtn.textContent = "Verify E-mail";
                  verifyBtn.href = "#";
                }
    
                console.log("Logged in:", user.email);
                console.log("Verified:", user.emailVerified);
              })
              .catch((error) => {
                console.log("Error reloading user:", error);
              });
    
          } else {
            updateDropdownEmail(null); 
          }
        });
    
        const signOutUser = () => {
          signOut(auth)
            .then(() => {
              console.log('Signed out successfully');
              window.location.href = 'auth/login.html'; 
            })
            .catch((error) => {
              console.log('Error signing out:', error);
              alert("Error: " + error.message);
            });
        };
    
        const verifyEmail = () => {
          const user = auth.currentUser;
          if (user) {
            sendEmailVerification(user)
              .then(() => {
                alert("Verification email sent!");
              })
              .catch((error) => {
                console.log('Error sending verification email:', error);
                alert("Error: " + error.message); 
              });
          }
        };
    
        document.getElementById('logoutBtn').addEventListener('click', signOutUser);
        document.getElementById('verifyBtn').addEventListener('click', verifyEmail); 
    
        const loginBtn = document.getElementById('loginBtn');
        loginBtn.onclick = () => {
          const user = auth.currentUser; 
          if (user) {
            window.location.href = 'auth/userprofile.html'; 
          } else {
            window.location.href = 'auth/login.html'; 
          }
        };
      </script>

<script type="module" src="appoint.js"></script>

</body>
</html>